{{define "admin_storage"}}
  {{template "admin_base" .}}
{{end}}

{{define "admin_storage_section"}}
<div class="container mt-4">

  {{if .Error}}
  <div class="notification is-danger">
    <p><strong>{{T "Common.Error"}}:</strong> {{.Error}}</p>
    <a href="/admin/storage?lang={{.Lang}}" class="button is-small is-light mt-2">
      <span>{{T "Common.TryAgain"}}</span>
    </a>
  </div>
  {{else}}
  <div class="content mb-5">
      <h1 class="title is-4"><span class="icon"><i class="fas fa-hdd"></i></span>&nbsp;{{T "Admin.Storage.Title"}}</h1>
      <p class="subtitle is-6 has-text-grey">{{T "Admin.Storage.Description"}}</p>
  </div>
  {{if .Storages}}
  <div class="table-container">
    <table class="table is-fullwidth is-striped is-hoverable is-narrow">
      <thead>
        <tr>
          <th><span class="icon is-small"><i class="fas fa-hdd"></i></span>&nbsp;{{T "Admin.Storage.Title"}}</th>
          <th>{{T "Admin.Storage.Header.Usage"}}</th>
          <th>{{T "Admin.Storage.Header.Type"}}</th>
          <th class="has-text-right">{{T "Common.Actions"}}</th>
        </tr>
      </thead>
      <tbody>
        {{range .Storages}}
        {{$used := .Used}}
        {{$total := .Total}}
        {{$percent := mul (div $used $total) 100.0}}
        <tr>
          <td>{{.Storage}}</td>
          <td>
            <div class="is-flex is-align-items-center is-justify-content-space-between">
              <span class="is-size-7">{{$used | humanBytes}} / {{$total | humanBytes}}</span>
              <span class="tag is-light is-size-7">{{printf "%.0f" $percent}}%</span>
            </div>
            <progress class="progress is-small {{if lt $percent 70.0}}is-success{{else if lt $percent 90.0}}is-warning{{else}}is-danger{{end}}" value="{{printf "%.0f" $percent}}" max="100"></progress>
          </td>
          <td>
            <div class="tags is-inline-block">
              {{range $type := split .Content ","}}
                <span class="tag is-info is-light">{{$type}}</span>
              {{end}}
            </div>
          </td>
          <td class="has-text-right">
            <form method="POST" action="/admin/storage/toggle" class="is-inline">
              <input type="hidden" name="csrf_token" value="{{$.CSRFToken}}">
              <input type="hidden" name="storage" value="{{.Storage}}">
              <input type="hidden" name="action" value="{{if index $.EnabledMap .Storage}}disable{{else}}enable{{end}}">
              <button type="submit" class="button is-small {{if index $.EnabledMap .Storage}}is-success{{else}}is-light{{end}}"
                aria-label="{{if index $.EnabledMap .Storage}}{{T "Common.Disable"}}{{else}}{{T "Common.Enable"}}{{end}} {{.Storage}}"
                title="{{if index $.EnabledMap .Storage}}{{T "Common.Disable"}}{{else}}{{T "Common.Enable"}}{{end}} {{.Storage}}">
                <span class="icon is-small">
                  {{if index $.EnabledMap .Storage}}
                    <i class="fas fa-toggle-on"></i>
                  {{else}}
                    <i class="fas fa-toggle-off"></i>
                  {{end}}
                </span>
                <span>{{if index $.EnabledMap .Storage}}{{T "Common.Disable"}}{{else}}{{T "Common.Enable"}}{{end}}</span>
              </button>
            </form>
          </td>
        </tr>
        {{end}}
      </tbody>
    </table>
  </div>
  {{else}}
  <div class="notification is-warning">
    {{T "Admin.Storage.NoStorages"}}
  </div>
  {{end}}
  {{end}}
</div>
{{end}}