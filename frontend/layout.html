{{define "layout"}}
<!DOCTYPE html>
<html lang="{{.Lang}}" data-theme="{{.Theme}}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="{{T "UI.Header"}} - {{T "UI.Subtitle"}}">
    <meta name="csrf-token" content="{{.CSRFToken}}">
    <meta name="color-scheme" content="{{.Theme}}">
    <title>
        {{- if .Title -}}
            {{.Title}} - {{T "UI.Header"}}
        {{- else if .TitleKey -}}
            {{T .TitleKey}} - {{T "UI.Header"}}
        {{- else -}}
            {{T "UI.Header"}}
        {{- end -}}
    </title>

    <link rel="stylesheet" href="/css/bulma.min.css">
    <link rel="stylesheet" href="/css/tokens.css">
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/components.css">
    <link rel="stylesheet" href="/css/admin.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="/css/fontawesome.min.css">
    <link rel="stylesheet" href="/css/solid.min.css">
    <link rel="stylesheet" href="/css/regular.min.css">
    <link rel="stylesheet" href="/css/brands.min.css">
    <!-- Preload local Font Awesome webfonts for faster icon rendering -->
    <link rel="preload" href="/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
</head>
<body>
    <!-- Skip to main content for keyboard and screen reader users -->
    <a class="skip-link" href="#main-content">Skip to content</a>
    
    {{template "navbar" .}}

    {{/* Proxmox Connection Status Banner - Server-side rendered */}}
    {{if not .ProxmoxConnected}}
    <input type="checkbox" id="pmx-dismiss" class="visually-hidden-checkbox" aria-label="Dismiss Proxmox status banner">
    <div class="notification is-danger is-light" id="proxmox-status-banner" role="alert" aria-live="assertive">
        <div class="container">
            <div class="level is-mobile">
                <div class="level-left">
                    <div class="level-item">
                        <span class="icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </span>
                    </div>
                    <div class="level-item status-text">
                        <strong>{{T "Proxmox.ConnectionError"}} : </strong> 
                        {{if .ProxmoxError}}
                            {{.ProxmoxError}}
                        {{else}}
                            {{T "Proxmox.NotConnected"}} {{T "Proxmox.NotConnectedMessage"}}
                        {{end}}

    {{/* Optional Flash Messages slot (override with a template defining "flash") */}}
    <div role="status" aria-live="polite">
    {{block "flash" .}}{{end}}
    </div>
                    </div>
                </div>
                <div class="level-right">
                    <label for="pmx-dismiss" class="delete" role="button" aria-label="Dismiss notification" aria-controls="proxmox-status-banner"></label>
                </div>
            </div>
        </div>
    </div>
    {{end}}

    <main id="main-content" class="section">
        <div class="container">
            {{/* Optional Breadcrumbs slot (override with a template defining "breadcrumbs") */}}
            {{block "breadcrumbs" .}}{{end}}
            {{if .Content}}
                {{.Content}}
            {{else}}
                {{/* Default content if no content template is defined */}}
                <h1 class="title">{{T "UI.Header"}}</h1>
                <p>No content available</p>
            {{end}}
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="content has-text-centered">
                <p>
                    <span class="icon-text">
                        <span class="icon">
                            <i class="fas fa-server"></i>
                        </span>
                        <span>{{T "UI.Footer"}}</span>
                    </span>
                </p>
            </div>
        </div>
    </footer>

  </body>
</html>
{{end}}