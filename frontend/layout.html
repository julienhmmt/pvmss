{{define "layout"}}
<!DOCTYPE html>
<html lang="{{.Lang}}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="{{.UI.Header}} - {{.UI.Subtitle}}">
    <meta name="csrf-token" content="{{.CSRFToken}}">
    <title>{{.Title}} - {{.UI.Header}}</title>
    <link rel="stylesheet" href="/css/bulma.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="/css/fontawesome.min.css">
    <link rel="stylesheet" href="/css/solid.min.css">
    <link rel="stylesheet" href="/css/regular.min.css">
    <link rel="stylesheet" href="/css/brands.min.css">
</head>
<body>
    
    {{template "navbar" .}}

    <main id="main-content" class="section">
        <div class="container">
            {{if .Content}}
                {{.Content}}
            {{else}}
                {{/* Default content if no content template is defined */}}
                <h1 class="title">{{index .t "Title"}}</h1>
                <p>No content available</p>
            {{end}}
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="content has-text-centered">
                <p>{{index .t "UI.Footer"}}</p>
            </div>
        </div>
    </footer>

    <script>
        // Fonction utilitaire pour récupérer le jeton CSRF
        function getCSRFToken() {
            return document.querySelector('meta[name="csrf-token"]')?.content || 
                   document.querySelector('input[name="csrf_token"]')?.value || '';
        }

        // Gestion du menu burger
        document.addEventListener('DOMContentLoaded', function() {
            const burger = document.querySelector('.navbar-burger');
            const menu = document.querySelector('.navbar-menu');
            
            if (burger && menu) {
                burger.addEventListener('click', function() {
                    burger.classList.toggle('is-active');
                    menu.classList.toggle('is-active');
                });
            }

            // Ajouter le jeton CSRF à toutes les requêtes AJAX par défaut
            document.addEventListener('htmx:configRequest', function(event) {
                const csrfToken = getCSRFToken();
                if (csrfToken && !event.detail.headers['X-CSRF-Token']) {
                    event.detail.headers['X-CSRF-Token'] = csrfToken;
                }
            });
        });
    </script>
</body>
</html>
{{end}}