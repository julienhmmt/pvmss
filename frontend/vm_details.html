{{define "vm_details"}}
<section class="section">
    <div class="container">
        <h1 class="title">
            <span class="icon-text">
                <span class="icon">
                    <i class="fas fa-server"></i>
                </span>
                <span>{{.VMName}} (ID: {{.VMID}})</span>
            </span>
        </h1>
        <div class="box">
            <table class="table is-fullwidth">
                <tbody>
                    <tr>
                        <th><i class="fas fa-tag"></i> {{index .t "VMDetails.Label.Name"}}</th>
                        <td>{{.VMName}}</td>
                    </tr>
                    <tr>
                        <th><i class="fas fa-hashtag"></i> {{index .t "VMDetails.Label.ID"}}</th>
                        <td>{{.VMID}}</td>
                    </tr>
                    <tr>
                        <th><i class="fas fa-power-off"></i> {{index .t "VMDetails.Label.Status"}}</th>
                        <td>
                            <span id="vm-status-badge" class="tag is-medium {{if eq .Status "running"}}is-success{{else if eq .Status "stopped"}}is-danger{{else}}is-light{{end}}">
                                <span id="vm-status-text">{{.Status}}</span>
                            </span>
                        </td>
                    </tr>
                    <tr>
                        <th><i class="fas fa-clock"></i> {{index .t "VMDetails.Label.Uptime"}}</th>
                        <td>{{.Uptime}}</td>
                    </tr>
                    <tr>
                        <th><i class="fas fa-microchip"></i> {{index .t "VMDetails.Label.CPU"}}</th>
                        <td>{{.Sockets}} sockets / {{.Cores}} cores</td>
                    </tr>
                    <tr>
                        <th><i class="fas fa-memory"></i> {{index .t "VMDetails.Label.RAM"}}</th>
                        <td>{{.RAM}}</td>
                    </tr>
                    <tr>
                        <th><i class="fas fa-hdd"></i> {{index .t "VMDetails.Label.Disk"}}</th>
                        <td>{{.DiskCount}} ({{.DiskTotalSize}})</td>
                    </tr>
                    <tr>
                        <th><i class="fas fa-network-wired"></i> {{index .t "VMDetails.Label.Network"}}</th>
                        <td>{{.NetworkBridges}}</td>
                    </tr>
                    <tr>
                        <th><i class="fas fa-info-circle"></i> {{index .t "VMDetails.Label.Description"}}</th>
                        <td>{{.Description}}</td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>

    <!-- Refresh Button -->
    <div class="is-flex is-justify-content-center mb-4" style="margin-top: 1.5rem;">
        <a class="button is-info is-light" href="/vm/details/{{.VMID}}" style="min-width: 170px; box-shadow: 0 2px 8px #e3e9f6; border-radius: 8px; display: flex; align-items: center; gap: 0.5em;">
            <span>{{index .t "VMDetails.Action.Refresh"}}</span>
        </a>
    </div>

    <!-- VM Action Forms (server-side) -->
    <div class="buttons is-centered mt-4">
        <form action="/vm/action" method="post" style="display:inline-block; margin: 0 0.25rem;">
            <input type="hidden" name="csrf_token" value="{{.CSRFToken}}" />
            <input type="hidden" name="vmid" value="{{.VMID}}" />
            <input type="hidden" name="node" value="{{.Node}}" />
            <input type="hidden" name="action" value="start" />
            <button class="button is-success is-light" {{if eq .Status "running"}}disabled{{end}}>
                <span>{{index .t "VMDetails.Action.Start"}}</span>
            </button>
        </form>
        <form action="/vm/action" method="post" style="display:inline-block; margin: 0 0.25rem;">
            <input type="hidden" name="csrf_token" value="{{.CSRFToken}}" />
            <input type="hidden" name="vmid" value="{{.VMID}}" />
            <input type="hidden" name="node" value="{{.Node}}" />
            <input type="hidden" name="action" value="reboot" />
            <button class="button is-warning is-light" {{if ne .Status "running"}}disabled{{end}}>
                <span>{{index .t "VMDetails.Action.Reboot"}}</span>
            </button>
        </form>
        <form action="/vm/action" method="post" style="display:inline-block; margin: 0 0.25rem;">
            <input type="hidden" name="csrf_token" value="{{.CSRFToken}}" />
            <input type="hidden" name="vmid" value="{{.VMID}}" />
            <input type="hidden" name="node" value="{{.Node}}" />
            <input type="hidden" name="action" value="shutdown" />
            <button class="button is-danger is-light" {{if ne .Status "running"}}disabled{{end}}>
                <span>{{index .t "VMDetails.Action.Shutdown"}}</span>
            </button>
        </form>
        <form action="/vm/action" method="post" style="display:inline-block; margin: 0 0.25rem;">
            <input type="hidden" name="csrf_token" value="{{.CSRFToken}}" />
            <input type="hidden" name="vmid" value="{{.VMID}}" />
            <input type="hidden" name="node" value="{{.Node}}" />
            <input type="hidden" name="action" value="stop" />
            <button class="button is-danger is-light" {{if ne .Status "running"}}disabled{{end}}>
                <span>{{index .t "VMDetails.Action.Stop"}}</span>
            </button>
        </form>
        <form action="/vm/action" method="post" style="display:inline-block; margin: 0 0.25rem;">
            <input type="hidden" name="csrf_token" value="{{.CSRFToken}}" />
            <input type="hidden" name="vmid" value="{{.VMID}}" />
            <input type="hidden" name="node" value="{{.Node}}" />
            <input type="hidden" name="action" value="reset" />
            <button class="button is-danger is-light" {{if ne .Status "running"}}disabled{{end}}>
                <span>{{index .t "VMDetails.Action.Reset"}}</span>
            </button>
        </form>
    </div>


    <div class="is-flex is-justify-content-center mb-4" style="margin-top: 1.5rem;">
        <a class="button is-info is-light" href="/search" style="min-width: 170px; box-shadow: 0 2px 8px #e3e9f6; border-radius: 8px; display: flex; align-items: center; gap: 0.5em;">
            <span>{{index .t "Common.BackToSearch"}}</span>
        </a>
    </div>

    </div>
</section>
{{end}}
